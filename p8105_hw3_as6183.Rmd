---
title: "p8105_hw3_as6183"
output: github_document
---

# Problem 1:
```{r}
library(p8105.datasets)
library(tidyverse)
library(plyr)
library(dplyr)
data("instacart")
```
The Instacart data set gives information on over 3 million online grocery orders from more than 200,000 Instacart users in 2017. The size of this dataset is `r nrow(instacart)` rows and `r ncol(instacart)` columns. Some key variables would be the reordered variable to assess what customers are re-buying frequently, the product name to analyze what products are customers buying most and least frequently, the user id to keep track of which customer is buying what, and the department to analyze which category of items are getting purchased most/least frequently. 

```{r}
number_aisles = count(instacart,vars=c('aisle','aisle_id'))%>%
  nrow()

most_ordered = instacart%>%
  count(vars=c('aisle','aisle_id'))%>%
  select('freq')%>%
  max()
```
There are `r number_aisles` aisles and 

```{r}
library(ggplot2)
aisles_10000 = instacart%>%
  count(vars=c('aisle','aisle_id'))%>%
  filter(freq>10000)

instacart_10000 = filter(instacart,aisle%in%pull(aisles_10000,aisle))

ggplot(instacart_10000,aes(x=aisle))+geom_bar()
```

```{r}
#library(data.table)
data = instacart%>%
  filter(aisle=="baking ingredients"|aisle=="dog food care"|aisle=="packaged vegetables fruits")

most_popular = data%>%
  count(vars=c('aisle','product_name'))

most_popular = most_popular%>%
  group_by(aisle)%>%
  dplyr::arrange(desc(freq),by_group=T)%>%
  top_n(n=3,wt=freq)

#data.table(aisle=pull(most_popular,aisle),product_name=pull(most_popular,product_name),freq=pull(most_popular,freq))
```

```{r}
library(dplyr)
pink_lady_coffee_ice_cream = instacart%>%
  filter(product_name=="Pink Lady Apples"|product_name=="Coffee Ice Cream")%>%
  group_by(order_dow,product_name)
  
table = dplyr::summarise(pink_lady_coffee_ice_cream,mean=mean(order_hour_of_day))%>%
  ungroup()%>%
  pivot_wider(names_from=order_dow,values_from=mean)
colnames(table) = c("Product Name", "Monday", "Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday")
table
```

# Problem 2:
